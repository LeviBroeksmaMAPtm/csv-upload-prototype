<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  <meta name="description" content="Tailwind CSS - MAPtm template">
  <meta name="author" content="by MAPtm">

  <title>Tailwind CSS - MAPtm template</title>

  <!-- Favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/site.webmanifest">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="/icons/favicon.ico">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-config" content="/icons/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">

  <!-- Configuration -->
  <script defer src="./config.min.js" inline></script>

  <!-- Tailwind CSS -->
  <link rel="stylesheet" href="./assets/tailwind.min.css" inline>

  <!-- AWS Cognito -->
  <script defer src="./assets/aws-sdk-2.610.0.min.js"></script>
  <script defer src="./assets/amazon-cognito-identity.min.js"></script>
  <script defer src="./assets/maptm_cognito.js"></script>

  <!-- Alpine.js -->
  <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.7.0/dist/alpine.min.js" defer></script>

  <!-- Diff.js -->
  <script defer src="./assets/diff.js"></script>

  <!-- Helper functions -->
  <script defer src="./assets/helper_functions.js"></script>

  <!-- Main -->
  <link rel="stylesheet" href="./main.min.css" inline>
  <script defer src="./main.min.js" inline></script>

  <!-- Other JavaScript dependencies -->

</head>

<body data-app="home" class="w-full h-screen flex items-center justify-center">

  <div>
    <form id="myForm" class="flex flex-col h-24 justify-between">
      <input type="file" id="csvFile" accept=".csv" />
      <input type="submit" value="Submit" class="cursor-pointer py-2 rounded-full bg-gray-800 hover:bg-gray-600 text-white transition duration-300"/>
    </form>
  </div>



  <script>
    const myForm = document.getElementById("myForm");
    const csvFile = document.getElementById("csvFile");

    myForm.addEventListener("submit", function (e) {
      try {
        e.preventDefault();

        const input = csvFile.files[0];

        const reader = new FileReader();

        reader.onload = function (e) {
          const text = e.target.result;
          const data = csvToArray(text);

          // document.write(JSON.stringify(data));
          console.log(data)

        };

        reader.readAsText(input);
      } catch (e) {
        console.error( "You need to upload a file first.", e)
      }

    });

    function csvToArray(str, delimeter = ",") {
      // split up the csv data of the first row as headers:
      const headers = str.slice(0, str.indexOf("\n")).split(delimeter);
      // split up the csv data of the rows, devided per row
      const rows = str.slice(str.indexOf("\n") + 1).split("\n");

      const arr = rows.map(function (row) {
        const values = row.split(delimeter);

        const el = headers.reduce(function (object, header, index) {
          object[header] = values[index];
          return object;
        }, {});

        return el;

      })
      return arr;
    }
  </script>

  <!-- Alpine.js dependencies -->
  <script src="./_imports/alpine_func_footer.min.js"></script>
  <!-- <script src="./alpine_func_users.min.js"></script> -->
  <!-- <script src="./alpine_func_projects.min.js"></script> -->
</body>

</html>